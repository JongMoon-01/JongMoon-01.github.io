---
title: "컴퓨터 네트워크 2주차"
date: 2024-09-09 02:23:00 +0900
categories: [Network]
tags: [V2X, Network, Python]
---

# 1. 계층구조의 개념
- 계층 모듈 구조
    - 모듈화
        - 복잡한 시스템을 기능별로 모듈화하면 시스템 구조가 단순해짐
        - 프로그래밍 언어에서는 함수개념을 사용해 전체 프로그램 모듈화
    - 계층 구조
        - 특정 모듈이 다른 모듈에 서비스를 제공하는 형식의 계층 구조
        - 네트워크에서도 독립 고유 기능을 수행하는 모듈이 상하위 계층 구조로 연결되어 도앚ㄱ

<center>
<img src="https://github.com/user-attachments/assets/42cafe33-9bb4-435a-b26b-e4ba34c3a6cc" width="720" height=""/>
<p><b>[그림1]. 계층 모듈 구조  </b></p>
</center>

<center>
<img src="https://github.com/user-attachments/assets/bc9e837f-09bf-4491-a81d-a9df5dcb1601" width="480" height=""/>
<p><b>[그림2]. 모듈 구조 서비스  </b></p>
</center>

- 계층 구조 개념
    - 계층 구조 장점
        - 전체 시스템 이해하기 쉽고, 설계 및 구현 용이
        - 모듈간 표준 인터페이스가 단순하면 모듈 독립성 향상 -> 시스템 구조 단순화
        - 대칭 구조에서 동일 계층 사이의 인터페이스인 프로토콜 단순화 가능
        - 특정 모듈의 외부 인터페이스가 변하지 않으면 내부 기능변화가 전체시스템에 영향 X

    - 프로토콜 설계시 고려 사항
        - 주소 표현
            - 주소 역할 : 서로 구분
            - 주소 활용도를 높이기 위해 구조 정보 포함 -> 전화번호 : 국가코드 - 지역 코드 - 번호
            - 1:다 통신 지원 -> BroadCasting, Multicasting
        - 오류제어
            - 데이터 변형 오류 : 데이터가 꺠져서 도착
            - 데이터 분실 오류 : 데이터 도착 X
            - 오류 제어기능은 통신 프로토콜의 가장 기본 기능
        - 흐름 제어
            - 수신 호스트의 버퍼처리 속도보다 송신 호스트가 데이터 전송 속도가 빠르면 논리 데이터 분실 오류가 발생할 수 있음
            - 따라서 송신 호스트의 전송 속도를 조절하는 흐름 제어기능
        - 데이터 전달 방식
            - 단방향 : 데이터를 한쪽 방향으로만 전송
            - 전이중 : 데이터를 양쪽에서 동시에 전송(보통 해당 방식 사용)
            - 반이중 : 양방향으로 전송 가능, 특정시점에서는 단방향으로만 전송(ex. 무전기)

<center>
<img src="https://github.com/user-attachments/assets/5b47f85d-7e06-414b-baa6-23fd1e06f834" width="720" height=""/>
<p><b>[그림3]. 프로토콜 오류 상황(물리 계층--문제 발생 계층, 데이터 링크 계층-문제 해결 계층)  </b></p>
</center>

<center>
<img src="https://github.com/user-attachments/assets/ebc6368b-ea6a-47eb-b977-ff32f6d04260" width="720" height=""/>
<p><b>[그림4]. 흐름 제어(버퍼 속도 조정)  </b></p>
</center>


* 보통 데이터 변형이 일어나면 수신하는쪽에서 error detecting 기법을 사용해 검출함, 검출되면 송신쪽에서 재전송
* 입력큐 사이즈 이상의 입력은 다 버려지게 떄문에 프로토콜 설계 시 이도 고려해야함.
* Unicast : 일반적인 1대1 통신




- 서비스 프리미티브(OSI 7 Layer 및 TCP/IP의 상위 계층과 하위 계층의 서비스 요구, 지시, 응답, 확인 통한 계층 간 통신 기능)
    - 계층구조 프로토콜에서 하위 계층이 상위 계층에 제공하는 서비스의 종류에는 연결형, 비연결형이 있으며 primitive 형태로 구현됨
    - 연결형 서비스 - Connection-oriented 서비스를 이용하는 3단계(ex. 전화 서비스)
    - 비연결형 서비스 : 전송 데이터가 있으면 각 데이터를 독립적으로 목적지 호스트로 전송

- 연결형 서비스 3단계

|종류|용도|
|:------:|:-------:|
|CONNECT|연결 설정|
|DATA|데이터 전송|
|DISCONNECT|연결해제|

- 서비스 프리미티브 기능

|기능|설명|
|:-------------:|:-------------:|
|Request|클라이언트가 서버에 서비스 요청|
|indication|서버에 서비스 요청이 도착함을 인지|
|Response|서버가 클라이언트 서비스 응답을 회신|
|Confirm|클라이언트에 응답 도착함을 통지|

- 서비스 프리미티브 동작 원리
CONNECT, DATA, DISCONNECT [primitive service function] 각 기능은 3단계에 걸쳐 동작
    - Request
    - indication
    - Response
    - Confirm

<center>
<img src="https://github.com/user-attachments/assets/501a9937-2797-4ce4-ab59-d693933adc13" width="720" height=""/>
<p><b>[그림5]. 서비스 프리미티브  </b></p>
</center>

# 2. OSI 참조 모델(중요)
- 용어 정의
    - 계층n 프로토콜 : 계층 n 모듈끼리 사용하는 통신 규칙
    - 동료 프로세스 : 동일 계층에 위치한 통신 양단 프로세스
    - 인터페이스 : 인접 상하위 계층 사이의 접속 방법
    - 서비스 : 상위 계층이 하위 계층 사용하는 방법
- 헤더 정보
    - 송신 호스트 : 데이터가 상위 계층 -> 하위 계층으로 갈수록 헤더 추가
    - 수신 호스트 : 데이터가 하위 -> 상위 계층으로 갈수록 헤더 제거

* 개방형 시스템 상호 연결(OSI) 모델은 표준 프로토콜을 사용하여 다양한 통신 시스템이 통신할 수 있도록 국제표준화기구(ISO)에서 만든 개념 모델

<center>
<img src="https://github.com/user-attachments/assets/561fd824-6d76-4f05-b7c5-19f2ba36f6fd" width="720" height=""/>
<p><b>[그림6]. OSI 계층 헤더 추가 및 제거  </b></p>
</center>

- 중개 기능
호스트가 1:1로 Direct Connect가 아니고 여러 네트워크 노드(장치)를 통해 연결되어 있을 때 목적지까지 정확하게 안내할 수 있는 기능
    - 라우팅(보통 3계층으로 구성, L3 장비라고도 함) : 경로 배정 가능, 헤더 분석을 통해 다음 중개노드를 찾음

<center>
<img src="https://github.com/user-attachments/assets/48dc3ec5-afd1-4250-aac9-4a5117476326" width="720" height=""/>
<p><b>[그림7]. OSI 계층 중개  </b></p>
</center>
    
- 계층별 기능
    - 물리 계층
        - 전송매체의 물리 인터페이스 관한 사항 기술
        - 데이터 전송 속도, 송수신 호스트 사이의 클록 동기화 방법, 물리적 연결형태 등
    - 데이터링크 계층(Map 계층이라고도 함)
        - 데이터 물리 전송 오류 해결
        - 프레임 : 전송 데이터 명칭
    - 네트워크 계층
        - 송신 호스트가 전송할 데이터가 어떤 경로를 통해 수신 호스트에 전달되는지 결정하는 라우팅 문제 처리(라우팅은 정적, 동적 둘다 존재)
        - 호스트 구분을 위한 주소 개념 필요(ex. IP ADDR)
        - Packet : 전송 데이터 명칭
        - <code>혼잡 제어</code> : 데이터 전송 경로의 선택에 따라 네트워크 혼잡에 영향을 미침
    - 전송 계층
        - 송신 프로세스와 수신 프로세스를 직접 연결하는 단대단(end2end) 통신 기능 제공
    - 세션 계층
        - 송수신 호스트 사이의 대화 제어를 비롯 상호 배타적인 동작을 제어하기 위한 토큰 제어
        - 일시적인 전송장애를 해결하기 위한 동기화 기능 제공
    - 표현 계층
        - 데이터의 의미와 표현 방법을 처리, 데이터를 코딩하는 문제를 다룸
    - 응용 계층
        - 최상위, 다양하게 존재하는 응용환경에서 공통으로 필요한 기능을 다룸
        - ex. FTP, telnet, Email

지금 세션 계층과 표현 계층은 응용 계층에 흡수되서 거의 흔적만 남아있는 상태, 세션 계층은 로그인을 담당하는 곳이라 생각하면 간단함.

# 3. TCP/IP 모델

- 구현 환경
    - 시스템 공간(L1 ~ L4)
        - TCP와 UDP는 시스템 OS인 Kernel에서 구현
        - 네트워크 계층은 IP로 구현, 전송 패킷의 올바른 경로 선택 기능 제공
    - 사용자 공간 (L5 ~ L7)
        - 사용자 프로그램으로 구현
        - 전송 계층의 기능을 제공하는 소켓 시스템 콜을 호출해 TCP와 UDP 기능을 사용

윈도우 기반 장비는 모두 TCP/IP(TCP + UDP) 기반으로 통신을 구현, OS kernel안에 OSI 계층이 담겨있다고 생각하면됨.

인터넷은 데이터 중개 기능을 담당하는 네트워크 계층의 이름이다. 인터넷은 IP라는 프로토콜을 사용, 그렇기떄문에 통신하려면 TCP/IP 프로토콜을 사용 및 지원해야함.

LAN 카드는 1계층 물리 계층과 연결, 드라이버 루틴은 2계층 데이터 링크 계층과 연결 IP는 네트워크 계층, TCP는 전송 계층, 5,6,7 계층은 사용자 공간으로 구현.

일반 사용자들은 TCP/IP 기능을 직접 사용하진 않음. Socket or Packet Driver와 같은 인터페이스로 접근 가능.(보통 OS kernel 내부에 구현되기 때문, 코딩으로 어느정도 직접 접근 가능)

<center>
<img src="https://github.com/user-attachments/assets/88b42e3b-31b8-4270-8742-a90d40af4f9c" width="720" height=""/>
<p><b>[그림8]. TCP/IP 모델  </b></p>
</center>

- 프로토콜
    - TCP/IP 계층 구조
        - TCP/UDP : 사용자 데이터를전송하는 전송 계층 프로토콜
        - IP : 사용자 데이터 전송하는 네트워크 계층 프로토콜 -> 오류 정보 전송 목적으로 ICMP 사용
        - ARP(2.5계층) : IP 주소를 MAC 주소로 변환(ReverseARP는 반대 역할)
        - ICMP(3.5계층) : 오류 메시지를 전송하는 프로토콜, IP 프로토콜에 의해 캡슐화되어 전송됨(ex. Ping 기능, 만약 오류 발생하면 송신측으로 회신해서 재전송 요구를 요청)

|프로토콜|특징|
|:-----------|:---------------|
|ARP|인터넷에서 통신하려면 자신의 Local IP ADDR와 MAC ADDR, remote host의 IP ADDR + MAC ADDR이 필요하다. ARP(Address Resolution Protocol)은 remote host의 주소변환기능을 제공하는데, 사용자가 입력한 IP ADDR을 이용해 MAC ADDR을 제공하는 프로토콜이다.|
|RARP|Local host의 주소 변환 기능을 제공한다. LAN Card에 보관된 MAC ADDR을 이용해 IP ADDR을 제공하는 프로토콜이다. 일반 컴퓨터 시스템은 Local Host의 IP ADDR이 File System에 보관되므로 RARP는 사용하지 않지만, DISK가 장착되지 않은 시스템에서는 RARP를 반드시 사용핻야한다.|
|ICMP|사용자 데이터의 전송과정에서 오류 발생시 오류 메시지가 생성되는데 ICMP는 이를 전송하는 기능을 담당하는 프로토콜이다.|

각 계층별로 주소 체계가 있음. 예를 들자면 2계층에서는 MAC주소, 3계층에서는 IP주소, 4계층에서는 포트 번호가 이에 해당됨

* 캡술화하면 내부에 메시지 확인불가. 어떤 메시지 타입인지는 확인 가능

<center>
<img src="https://github.com/user-attachments/assets/006f39a1-462f-4ac5-b69f-88b689b70d36" width="720" height=""/>
<p><b>[그림9]. TCP/IP 계층  </b></p>
</center>
